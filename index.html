<!-- index.html (The All-In-One Website) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEVER HIDE chat Camp</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root{--primary-color:#005c4b;--secondary-color:#008069;--background-color:#dadada;--message-out-bg:#d9fdd3;--message-in-bg:#ffffff;--font-family:'Poppins',sans-serif}body{font-family:var(--font-family);margin:0;background-color:var(--background-color);display:flex;justify-content:center;align-items:center;height:100vh}#lobby-container{text-align:center;padding:40px;background:#fff;border-radius:10px;box-shadow:0 5px 20px rgba(0,0,0,.2)}.form-box h1{color:var(--primary-color)}.form-box input{display:block;width:100%;box-sizing:border-box;padding:12px;margin:15px 0;border:1px solid #ccc;border-radius:5px;font-size:1em}.form-box button{width:100%;padding:12px;border:none;background:var(--secondary-color);color:#fff;border-radius:5px;cursor:pointer;font-size:1.1em;font-weight:600}.hidden{display:none}#chat-room-container{display:flex;width:95%;max-width:1000px;height:95vh;box-shadow:0 4px 20px rgba(0,0,0,.15);border-radius:10px;overflow:hidden}#sidebar{width:250px;background-color:#fff;border-right:1px solid #ddd;padding:15px;display:flex;flex-direction:column;box-sizing:border-box;}#sidebar h3{margin-top:0;font-size:1em;color:var(--primary-color);border-bottom:2px solid var(--primary-color);padding-bottom:10px}#room-name-display{font-weight:700;color:#000}#user-list{list-style-type:none;padding:0;margin:0;flex-grow:1;overflow-y:auto}#user-list li{padding:8px 0;border-bottom:1px solid #f0f0f0;color:#555}.chat-app{flex-grow:1;background:#fff;display:flex;flex-direction:column}.chat-header{background:var(--secondary-color);color:#fff;padding:15px 20px;text-align:center}.chat-header h1{margin:0;font-size:1.5em}#messages{list-style-type:none;margin:0;padding:10px;flex-grow:1;overflow-y:auto;background-color:#e5ddd5}#messages li{padding:8px 12px;margin-bottom:10px;border-radius:15px;max-width:75%;word-wrap:break-word;display:block;clear:both;float:left}#messages li.my-message{background:var(--message-out-bg);float:right}#messages li:not(.my-message):not(.system-message){background:var(--message-in-bg);float:left;box-shadow:0 1px 1px rgba(0,0,0,.05)}#messages li.system-message{text-align:center;color:#666;font-size:.8em;width:100%;float:none;background:0 0}#typing-indicator{height:20px;padding:0 20px;font-style:italic;color:#666}#form{display:flex;padding:10px;background:var(--background-color);border-top:1px solid #ddd}#input{border:none;padding:15px;flex-grow:1;border-radius:30px;margin-right:10px;font-size:1em}#input:focus{outline:none}#form button{background:var(--primary-color);border:none;padding:0 25px;color:#fff;border-radius:30px;cursor:pointer;font-size:1em;font-weight:600}
    </style>
</head>
<body>
    <div id="lobby-container">
        <div class="form-box">
            <h1>Join an Event</h1>
            <input type="text" id="nickname-input" placeholder="Enter your nickname..." maxlength="15" />
            <input type="text" id="room-input" placeholder="Enter event/room name..." maxlength="20" />
            <button id="join-btn">Join Chat</button>
        </div>
    </div>
    <div id="chat-room-container" class="hidden">
        <div id="sidebar">
            <h3>Participants in <span id="room-name-display"></span></h3>
            <ul id="user-list"></ul>
        </div>
        <section class="chat-app">
            <header class="chat-header"><h1>NEVER HIDE chat Camp</h1></header>
            <ul id="messages"></ul>
            <div id="typing-indicator"></div>
            <form id="form" action=""><input id="input" autocomplete="off" placeholder="Type a message..." /><button>Send</button></form>
        </section>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const lobbyContainer = document.getElementById('lobby-container');
        const nicknameInput = document.getElementById('nickname-input');
        const roomInput = document.getElementById('room-input');
        const joinButton = document.getElementById('join-btn');
        const chatRoomContainer = document.getElementById('chat-room-container');
        const roomNameDisplay = document.getElementById('room-name-display');
        const userList = document.getElementById('user-list');
        const messages = document.getElementById('messages');
        const form = document.getElementById('form');
        const input = document.getElementById('input');
        let username = '';
        let room = '';

        joinButton.addEventListener('click', () => {
            const desiredUsername = nicknameInput.value.trim();
            const desiredRoom = roomInput.value.trim();
            if (desiredUsername && desiredRoom) {
                username = desiredUsername;
                room = desiredRoom;
                socket.emit('join room', { username, room });
                lobbyContainer.classList.add('hidden');
                chatRoomContainer.classList.remove('hidden');
                roomNameDisplay.textContent = room;
                input.focus();
            }
        });

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            if (input.value) {
                socket.emit('chat message', { username, room, message: input.value });
                input.value = '';
            }
        });
        
        socket.on('chat message', function(data) {
            const item = document.createElement('li');
            item.innerHTML = `<strong>${data.username}:</strong> ${data.message}`;
            if (data.username === username) {
                item.classList.add('my-message');
            }
            messages.appendChild(item);
            messages.scrollTop = messages.scrollHeight;
        });

        socket.on('system message', function(msg) {
            const item = document.createElement('li');
            item.textContent = msg;
            item.classList.add('system-message');
            messages.appendChild(item);
            messages.scrollTop = messages.scrollHeight;
        });
        
        socket.on('update users', function(users) {
            userList.innerHTML = '';
            users.forEach(function(user) {
                const item = document.createElement('li');
                item.textContent = user;
                userList.appendChild(item);
            });
        });
    </script>
</body>
  </html>
