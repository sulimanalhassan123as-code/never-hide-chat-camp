<!-- index.html (FINAL PRO VERSION with Scrollable Participant List) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEVER HIDE chat Camp</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root{--primary-color:#005c4b;--secondary-color:#008069;--background-color:#f0f2f5;--message-out-bg:#d9fdd3;--message-in-bg:#ffffff;--font-family:'Poppins',sans-serif}body{font-family:var(--font-family);margin:0;background-color:var(--background-color);display:flex;justify-content:center;align-items:center;height:100vh;padding:10px;box-sizing:border-box}.hidden{display:none !important}#lobby-container{width:100%;max-width:400px;text-align:center;padding:40px;background:#fff;border-radius:10px;box-shadow:0 5px 20px rgba(0,0,0,.1);box-sizing:border-box}.form-box h1{color:var(--primary-color)}.form-box input{display:block;width:100%;box-sizing:border-box;padding:12px;margin:15px 0;border:1px solid #ccc;border-radius:5px;font-size:1em}.form-box button{width:100%;padding:12px;border:none;background:var(--secondary-color);color:#fff;border-radius:5px;cursor:pointer;font-size:1.1em;font-weight:600}#chat-room-container{display:flex;flex-direction:column;width:100%;max-width:1000px;height:100%;box-shadow:0 4px 20px rgba(0,0,0,.15);border-radius:10px;overflow:hidden}#sidebar{background-color:#fff;padding:15px;box-sizing:border-box;border-bottom:1px solid #ddd;display:flex;flex-direction:column}#sidebar h3{margin-top:0;font-size:1em;color:var(--primary-color);border-bottom:2px solid var(--primary-color);padding-bottom:10px}#room-name-display{font-weight:700;color:#000}
        
        /* --- THIS IS THE ONLY PART THAT HAS CHANGED --- */
        #user-list{list-style-type:none;padding:0;margin:0;flex-grow:1;overflow-y:auto;}
        
        #user-list li{padding:8px 0;border-bottom:1px solid #f0f0f0;color:#555;display:flex;justify-content:space-between;align-items:center}.user-name{font-weight:600}.user-status{font-size:0.8em;font-style:italic;color:var(--secondary-color)}.online-indicator{height:8px;width:8px;background-color:#25d366;border-radius:50%;display:inline-block}.chat-app{flex-grow:1;background:#fff;display:flex;flex-direction:column;overflow:hidden}.chat-header{background:var(--secondary-color);color:#fff;padding:15px 20px;text-align:center}.chat-header h1{margin:0;font-size:1.2em}#messages{list-style-type:none;margin:0;padding:10px;flex-grow:1;overflow-y:auto;background-color:#e5ddd5}#messages li{padding:8px 12px;margin-bottom:10px;border-radius:15px;max-width:80%;word-wrap:break-word;display:block;clear:both;float:left}#messages li .msg-time{display:block;font-size:0.7em;color:#999;text-align:right;margin-top:5px}#messages li.my-message{background:var(--message-out-bg);float:right}#messages li:not(.my-message):not(.system-message){background:var(--message-in-bg);float:left;box-shadow:0 1px 1px rgba(0,0,0,.05)}#messages li.system-message{text-align:center;color:#666;font-size:.8em;width:100%;float:none;background:transparent}#typing-indicator{height:20px;padding:0 20px;font-style:italic;color:#666;background:#f0f2f5}#form{display:flex;padding:10px;background:#f0f2f5;border-top:1px solid #ddd}#input{border:none;padding:15px;flex-grow:1;border-radius:30px;margin-right:10px;font-size:1em}#input:focus{outline:none}#form button{background:var(--primary-color);border:none;padding:0 25px;color:#fff;border-radius:30px;cursor:pointer;font-size:1em;font-weight:600}@media (min-width:768px){#chat-room-container{flex-direction:row}#sidebar{width:250px;border-bottom:none;border-right:1px solid #ddd}}
    </style>
</head>
<body>
    <div id="lobby-container">
        <div class="form-box">
            <h1>Join an Event</h1>
            <input type="text" id="nickname-input" placeholder="Enter your nickname..." maxlength="15" />
            <input type="text" id="room-input" placeholder="Enter event/room name..." maxlength="20" />
            <button id="join-btn">Join Chat</button>
        </div>
    </div>
    <div id="chat-room-container" class="hidden">
        <div id="sidebar">
            <h3>Participants in <span id="room-name-display"></span></h3>
            <ul id="user-list"></ul>
        </div>
        <section class="chat-app">
            <header class="chat-header"><h1>NEVER HIDE chat Camp</h1></header>
            <ul id="messages"></ul>
            <div id="typing-indicator"></div>
            <form id="form" action=""><input id="input" autocomplete="off" placeholder="Type a message..." /><button>Send</button></form>
        </section>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket=io(),lobbyContainer=document.getElementById("lobby-container"),nicknameInput=document.getElementById("nickname-input"),roomInput=document.getElementById("room-input"),joinButton=document.getElementById("join-btn"),chatRoomContainer=document.getElementById("chat-room-container"),roomNameDisplay=document.getElementById("room-name-display"),userList=document.getElementById("user-list"),messages=document.getElementById("messages"),form=document.getElementById("form"),input=document.getElementById("input");let username="",room="",typingTimer;joinButton.addEventListener("click",()=>{const e=nicknameInput.value.trim(),t=roomInput.value.trim();e&&t&&(username=e,room=t,socket.emit("join room",{username:username,room:room}))}),form.addEventListener("submit",function(e){e.preventDefault(),input.value&&socket.emit("chat message",{username:username,room:room,message:input.value})&&(socket.emit("stop typing",{room:room,username:username}),clearTimeout(typingTimer),input.value="")}),input.addEventListener("input",()=>{clearTimeout(typingTimer),socket.emit("typing",{room:room,username:username}),typingTimer=setTimeout(()=>{socket.emit("stop typing",{room:room,username:username})},2e3)}),socket.on("join error",function(e){alert(e)}),socket.on("system message",function(e){"Welcome to the '"+room+"' event!"===e.text&&(lobbyContainer.classList.add("hidden"),chatRoomContainer.classList.remove("hidden"),roomNameDisplay.textContent=room,input.focus());const t=document.createElement("li");t.innerHTML=`${e.text} <span class="msg-time">${e.time}</span>`,t.classList.add("system-message"),messages.appendChild(t),messages.scrollTop=messages.scrollHeight}),socket.on("chat message",function(e){const t=document.createElement("li");t.innerHTML=`<strong>${e.username}:</strong> ${e.message}<span class="msg-time">${e.time}</span>`,e.username===username&&t.classList.add("my-message"),messages.appendChild(t),messages.scrollTop=messages.scrollHeight}),socket.on("update users",function(e){userList.innerHTML="",e.forEach(function(e){const t=document.createElement("li"),n=document.createElement("span");n.className="user-name",n.textContent=e.name;const s=document.createElement("span");s.className="user-status","online"===e.status?s.innerHTML='<span class="online-indicator"></span>':s.textContent=e.status,t.appendChild(n),t.appendChild(s),userList.appendChild(t)})});
    </script>
</body>
</html>
